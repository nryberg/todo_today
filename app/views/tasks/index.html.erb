<div class="tasks-header">
  <h2>Today's Tasks</h2>
  <div class="header-actions">
    <%= link_to "Add New Task", new_task_path, class: "btn btn-primary" %>
    <%= button_to "Reset All Tasks", reset_all_tasks_path, method: :delete,
        class: "btn btn-secondary",
        data: { confirm: "Are you sure you want to mark all tasks as undone?" } %>
  </div>
</div>

<div class="date-info">
  <%= Date.current.strftime("%A, %B %d, %Y") %>
</div>

<% if @tasks.empty? %>
  <div class="empty-state">
    <p>No tasks yet. Create your first task to get started!</p>
    <%= link_to "Create Task", new_task_path, class: "btn btn-primary" %>
  </div>
<% else %>
  <div class="tasks-list">
    <%= turbo_frame_tag "tasks" do %>
      <% @tasks.each do |task| %>
        <%= turbo_frame_tag dom_id(task) do %>
          <div class="task-item <%= 'completed' if task.completed_today? %>"
               data-controller="tasks"
               data-tasks-task-id-value="<%= task.id %>"
               data-tasks-completed-value="<%= task.completed_today? %>"
               data-tasks-item-target="item">
            <div class="task-content">
              <% if task.completed_today? %>
                <%= button_to "âœ“", uncomplete_task_path(task), method: :delete,
                    class: "task-checkbox checked",
                    data: {
                      tasks_checkbox_target: "checkbox",
                      action: "click->tasks#toggle"
                    } %>
              <% else %>
                <%= button_to "â—‹", complete_task_path(task), method: :post,
                    class: "task-checkbox",
                    data: {
                      tasks_checkbox_target: "checkbox",
                      action: "click->tasks#toggle"
                    } %>
              <% end %>

              <span class="task-name"><%= task.name %></span>

              <div class="task-completion-rate">
                <small><%= task.completion_rate(30) %>% (30 days)</small>
              </div>
            </div>

            <div class="task-actions">
              <%= link_to "Edit", edit_task_path(task), class: "btn btn-small" %>
              <%= button_to "Delete", task_path(task), method: :delete, class: "btn btn-small btn-danger", data: { confirm: "Are you sure?" } %>
            </div>
          </div>
        <% end %>
      <% end %>
    <% end %>
  </div>
<% end %>
